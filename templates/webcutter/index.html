{% extends 'base.html' %} 

{% block header %} 
{% endblock %} 

{% block content %}
<div id="vueApp">

    <!-- ANFANG -- Modal -->
    <ModalSlot>
        <template v-slot:header>
        <h4 class="modal-title" id="staticBackdropLabelSlot">[[ movie ]]</h4>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" v-if="!cut_ok"></button>
        </template>
    
        <template v-slot:body>
        <div class="container-fluid" v-if="!result_available">
        <div class="row">
            <div class="col-md-4">Section:</div>
            <div class="col-md-4">[[ section ]]</div>
        </div>
        <div class="row">
            <div class="col-md-4">Duration Raw:</div>
            <div class="col-md-4">[[ lmovie_info.duration ]] min</div>
        </div>
        <div class="row">
            <div class="col-md-4">Duration Cut:</div>
            <div class="col-md-4">[[ duration_cut ]] min</div>
        </div>
        <div class="row">
            <div class="col-md-4">In:</div>
            <div class="col-md-4">[[ t0 ]]</div>
        </div>
        <div class="row">
            <div class="col-md-4">Out:</div>
            <div class="col-md-4">[[ t1 ]]</div>
        </div>
        <div class="row">
            <div class="col-md-4">Recreate apsc:</div>
            <div class="col-md-4">[[ !lmovie_cut_info.apsc ]]</div>
        </div>
        <br>
        <div class="row">
            <div class="col-md-4">ETA:</div>
            <div class="col-md-4">[[ lmovie_cut_info.eta ]] sec, [[ eta_counter ]] sec</div>
        </div>
        </div>
        <div class="container-fluid" v-else>
        <div class="row">
            <pre class="col-md-12">[[ result ]]</pre>
        </div>                                        
        </div>                            
        </template>

        <template v-slot:footer>
            <button type="button" class="btn btn-primary" data-bs-dismiss="modal" v-if="result_available">Close</button>
            <br v-else>
        </template>
    </ModalSlot>
    <!--- ENDE -->


    <div class="row g-2 mt-1 justify-content-lg-center">
        <div class="form-floating col-6" id="vueSection">
            <select id="vueSectionID" v-model='section' class="form-select" @change="notifyme">
                    <option v-for="sec in sections" v-bind:value="sec">
                        [[ sec ]]
                    </option>            
            </select>
            <label for="vueSectionID" >[[ totalsections ]] Sections</label>
        </div>

        <div class="form-floating col-6" id="vueMovie">
            <select id="vueMovieID" v-model='movie' class="form-select" >
                <option v-for="movie in movies" v-bind:value="movie">
                    [[ movie ]]
                </option>                               
            </select>
            <label for="vueMovieID" >[[ totalmovies ]] recently added Movies</label>
        </div>            
    </div>

    <div class="row g-2 row-cols-7 justify-content-lg-center mt-1">
        <div class="col badge bg-light me-1"><button class="btn btn-light btn-sm">[[ section ]]</button></div>
        <div class="col badge bg-light me-1"><button class="btn btn-light btn-sm">[[ movie ]]</button></div>
        <div class="col badge bg-light me-1"><button class="btn btn-light btn-sm">[[ lmovie_info.duration ]] min</button></div>
        <!--div class="col badge bg-light me-1"><button class="btn btn-light btn-sm">[[ lmovie_cut_info.apsc ]]</button></div-->

        <div class="col badge bg-secondary me-1"><button class="btn btn-secondary text-light btn-sm" @click="test">[[ Math.trunc(lpos / 60) ]] min</button></div>

        <div class="col badge bg-primary me-1" v-if="t0_valid"><button class="btn btn-primary btn-sm" @click="hpos({type:'t0'})">[[ t0 ]] In </button></div>
        <div class="col badge bg-primary me-1" v-else><button class="btn btn-primary btn-sm" @click="hpos({type:'t0'})">--:--:-- In </button></div>

        <div class="col badge bg-primary me-1" v-if="t1_valid"><button class="btn btn-primary btn-sm" @click="hpos({type:'t1'})">[[ t1 ]] Out</button></div>
        <div class="col badge bg-primary me-1" v-else><button class="btn btn-primary btn-sm" @click="hpos({type:'t1'})">--:--:-- Out</button></div>

        <div class="col badge bg-primary me-1" v-if="cut_ok"><button class="btn btn-primary btn-sm" @click="toggle_inplace">inplace [[ inplace ? '✓' : '✗' ]]</button></div>
        <div class="col badge bg-secondary me-1" v-else><button class="btn btn-outline-secondary text-light btn-sm" disabled>inplace [[ inplace ? '✓' : '✗' ]]</button></div>

        <div class="col badge bg-danger" v-if="cut_ok"><button class="btn btn-danger btn-sm" @click="docut">Cut</button></div>
        <div class="col badge bg-secondary" v-else><button class="btn btn-outline-secondary text-light btn-sm" disabled>Cut</button></div>
    </div>

    <div class="row g-2 row-cols-9 p-0 pt-1 pb-1 m-0 mt-1 mb-1 justify-content-lg-center">   
            <button :class="b.class" v-for="b in bleft"  @click="hpos(b)">[[ b.name ]]</button>
            <input type="text" class="pos form-control-sm mt-0 col-2" placeholder="00:00:00" :value="pos" disabled>
            <button :class="b.class" v-for="b in bright" @click="hpos(b)">[[ b.name ]]</button>     
    </div>
    <div class="row g-2 mt-1">
        <img :src="pic_name" class="rounded mx-auto d-block mt-0" alt="... loading ...">
    </div>
</div>
{% endblock %}
{% block script %}
<script>
    Vue.prototype.$host = "http://{{ host }}"
</script>
<script src="{{ url_for('static', filename='js/components/Modal.js') }}"></script>
<script src="{{ url_for('static', filename='js/App.js') }}"></script>
{% endblock %}